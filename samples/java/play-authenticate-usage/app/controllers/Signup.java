begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_package
package|package
name|controllers
package|;
end_package

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Date
import|;
end_import

begin_import
import|import
name|models
operator|.
name|User
import|;
end_import

begin_import
import|import
name|models
operator|.
name|UserActivation
import|;
end_import

begin_import
import|import
name|play
operator|.
name|mvc
operator|.
name|Controller
import|;
end_import

begin_import
import|import
name|play
operator|.
name|mvc
operator|.
name|Result
import|;
end_import

begin_import
import|import
name|views
operator|.
name|html
operator|.
name|account
operator|.
name|signup
operator|.
name|*
import|;
end_import

begin_class
specifier|public
class|class
name|Signup
extends|extends
name|Controller
block|{
specifier|public
specifier|static
name|Result
name|unverified
parameter_list|()
block|{
return|return
name|ok
argument_list|(
name|unverified
operator|.
name|render
argument_list|()
argument_list|)
return|;
block|}
specifier|public
specifier|static
name|Result
name|exists
parameter_list|()
block|{
return|return
name|ok
argument_list|(
name|exists
operator|.
name|render
argument_list|()
argument_list|)
return|;
block|}
specifier|public
specifier|static
name|Result
name|verify
parameter_list|(
specifier|final
name|String
name|token
parameter_list|)
block|{
if|if
condition|(
name|token
operator|==
literal|null
operator|||
name|token
operator|.
name|trim
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
return|return
name|badRequest
argument_list|(
name|verify_no_token
operator|.
name|render
argument_list|()
argument_list|)
return|;
block|}
specifier|final
name|UserActivation
name|ua
init|=
name|UserActivation
operator|.
name|findByToken
argument_list|(
name|token
argument_list|)
decl_stmt|;
if|if
condition|(
name|ua
operator|==
literal|null
operator|||
name|ua
operator|.
name|expires
operator|.
name|before
argument_list|(
operator|new
name|Date
argument_list|()
argument_list|)
condition|)
block|{
return|return
name|badRequest
argument_list|(
name|verify_no_token
operator|.
name|render
argument_list|()
argument_list|)
return|;
block|}
name|User
operator|.
name|verify
argument_list|(
name|ua
operator|.
name|unverified
argument_list|)
expr_stmt|;
name|flash
argument_list|(
literal|"message"
argument_list|,
literal|"Email address successfully verified"
argument_list|)
expr_stmt|;
return|return
name|redirect
argument_list|(
name|routes
operator|.
name|Application
operator|.
name|login
argument_list|()
argument_list|)
return|;
block|}
block|}
end_class

end_unit

